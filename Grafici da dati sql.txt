
ANNO	CORSO_DI_LAUREA	ISCRITTI
2005	INFORMATICA	54
2006	INFORMATICA	200
2007	INFORMATICA	200
2008	INFORMATICA	295
2009	INFORMATICA	302
2005	ARCHITETTURA	65
2006	ARCHITETTURA	134
2007	ARCHITETTURA	187
2008	ARCHITETTURA	165
2009	ARCHITETTURA	202
2005	ECONOMIA	133
2006	ECONOMIA	215
2007	ECONOMIA	199
2008	ECONOMIA	205
2009	ECONOMIA	215



Grafico a torta:
ciascuna porzione rappresenta il numero di iscritti nell’anno accademico 2009 di un singolo corso di laurea. La query, deve restituire due campi: il corso di laurea e il numero di iscritti. La query è la seguente:
select corso_di_laurea, iscritti from iscritti where anno = 2009

Per ottenere il dataset, è necessario creare un’istanza della classe JDBCPieDataset. Il costruttore di questa classe riceve un oggetto ti tipo java.sql.Connection, che rappresenta la connessione al nostro database.

Fatto ciò, richiamiamo il metodo executeQuery() che riceve in ingresso la query sql da eseguire.

String sql = "select corso_di_laurea, iscritti from iscritti where anno = 2009";	
String url ="jdbc:mysql://" + host + "/" + dbname;	

Class.forName(driver); 
Connection con = DriverManager.getConnection(url, username, password);	
JDBCPieDataset dataset = new JDBCPieDataset(con);
dataset.executeQuery(sql);
con.close();

Ottenuto il dataset, non ci resta che passarlo al motore di rendering per la creazione del grafico vero e proprio. In questo caso creiamo un PieChart.

JFreeChart chart = ChartFactory.createPieChart(
                   "ISCRIZIONI", 
                   dataset, 
                   true, true, true);
ChartUtilities.saveChartAsPNG(new java.io.File("torta.png"), chart, 1000, 1000);

Istogramma
raggruppiamo i dati per anno accademico. Per ciascun anno visualizziamo il numero di iscritti di ciascun corso di laurea. La query, deve restituire 4 campi: l’anno accademico, il numero di iscritti del corso di Informatica per il corrispondente anno accademico, il numero di iscritti del corso di Architettura, e così via per gli altri corsi.
La query da utilizzare in questo esempio è la seguente:

String sql = "SELECT distinct(anno) as anno, 
  (select iscritti from iscritti where corso_di_laurea = 'INFORMATICA' and anno = i.anno) as informatica, 
  (select iscritti from iscritti where corso_di_laurea = 'ARCHITETTURA' and anno = i.anno) as architettura,
  (select iscritti from iscritti where corso_di_laurea = 'ECONOMIA' and anno = i.anno) as economia
  FROM iscritti i

La generazione del dataset, è praticamente identica a quella precedente. L’unica differenza è che occorre instanziare una classe JDBCCategoryDataset.

String sql = "SELECT distinct(anno) as anno, " +
  " (select iscritti from iscritti where corso_di_laurea = 'INFORMATICA' and anno = i.anno) as informatica," + 
  " (select iscritti from iscritti where corso_di_laurea = 'ARCHITETTURA' and anno = i.anno) as architettura" +
  " FROM iscritti i";	
String url ="jdbc:mysql://" + host + "/" + dbname;	
Class.forName(driver);	
Connection con = DriverManager.getConnection(url, username, password);		
JDBCCategoryDataset dataset = new JDBCCategoryDataset(con);		
dataset.executeQuery(sql);	
con.close();

Il rendering del grafico è leggermente differente poiché, in questo caso, occorre utilizzare il BarChart3D.

JFreeChart chart = ChartFactory.createBarChart3D( 
  "Istogramma", "Anno", "Numero di iscritti",
  dataset,
  PlotOrientation.VERTICAL,
  true, true, true);
ChartUtilities.saveChartAsPNG(new java.io.File("istogramma.png"), chart, 500, 500);